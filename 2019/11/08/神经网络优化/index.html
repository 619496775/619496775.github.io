<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta name="description" content="1 12345678910111213141516171819202122232425262728293031323334353637#coding:utf-8#é¢„æµ‹å¤šæˆ–é¢„æµ‹å°‘çš„å½±å“ä¸€æ ·#0å¯¼å…¥æ¨¡å—ï¼Œç”Ÿæˆæ•°æ®é›†import tensorflow as tfimport numpy as npBATCH_SIZE = 8SEED = 23455rdm = np.random.RandomState(">
<meta property="og:type" content="article">
<meta property="og:title" content="ç¥ç»ç½‘ç»œä¼˜åŒ–">
<meta property="og:url" content="http://yoursite.com/2019/11/08/ç¥ç»ç½‘ç»œä¼˜åŒ–/index.html">
<meta property="og:site_name" content="xuyasuoçš„åšå®¢">
<meta property="og:description" content="1 12345678910111213141516171819202122232425262728293031323334353637#coding:utf-8#é¢„æµ‹å¤šæˆ–é¢„æµ‹å°‘çš„å½±å“ä¸€æ ·#0å¯¼å…¥æ¨¡å—ï¼Œç”Ÿæˆæ•°æ®é›†import tensorflow as tfimport numpy as npBATCH_SIZE = 8SEED = 23455rdm = np.random.RandomState(">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://yoursite.com/2019/11/08/ç¥ç»ç½‘ç»œä¼˜åŒ–/1.png">
<meta property="og:image" content="http://yoursite.com/2019/11/08/ç¥ç»ç½‘ç»œä¼˜åŒ–/2.png">
<meta property="og:image" content="http://yoursite.com/2019/11/08/ç¥ç»ç½‘ç»œä¼˜åŒ–/3.png">
<meta property="og:image" content="http://yoursite.com/2019/11/08/ç¥ç»ç½‘ç»œä¼˜åŒ–/4.png">
<meta property="og:image" content="http://yoursite.com/2019/11/08/ç¥ç»ç½‘ç»œä¼˜åŒ–/4.png">
<meta property="og:image" content="http://yoursite.com/2019/11/08/ç¥ç»ç½‘ç»œä¼˜åŒ–/5.png">
<meta property="og:image" content="http://yoursite.com/2019/11/08/ç¥ç»ç½‘ç»œä¼˜åŒ–/6.png">
<meta property="og:image" content="http://yoursite.com/2019/11/08/ç¥ç»ç½‘ç»œä¼˜åŒ–/7.png">
<meta property="og:image" content="http://yoursite.com/2019/11/08/ç¥ç»ç½‘ç»œä¼˜åŒ–/8.png">
<meta property="og:image" content="http://yoursite.com/2019/11/08/ç¥ç»ç½‘ç»œä¼˜åŒ–/9.png">
<meta property="og:image" content="http://yoursite.com/2019/11/08/ç¥ç»ç½‘ç»œä¼˜åŒ–/10.png">
<meta property="og:updated_time" content="2019-11-08T13:48:41.879Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ç¥ç»ç½‘ç»œä¼˜åŒ–">
<meta name="twitter:description" content="1 12345678910111213141516171819202122232425262728293031323334353637#coding:utf-8#é¢„æµ‹å¤šæˆ–é¢„æµ‹å°‘çš„å½±å“ä¸€æ ·#0å¯¼å…¥æ¨¡å—ï¼Œç”Ÿæˆæ•°æ®é›†import tensorflow as tfimport numpy as npBATCH_SIZE = 8SEED = 23455rdm = np.random.RandomState(">
<meta name="twitter:image" content="http://yoursite.com/2019/11/08/ç¥ç»ç½‘ç»œä¼˜åŒ–/1.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'åšä¸»'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2019/11/08/ç¥ç»ç½‘ç»œä¼˜åŒ–/">





  <title>ç¥ç»ç½‘ç»œä¼˜åŒ– | xuyasuoçš„åšå®¢</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">xuyasuoçš„åšå®¢</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            é¦–é¡µ
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            å…³äº
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            æ ‡ç­¾
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            åˆ†ç±»
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            å½’æ¡£
          </a>
        </li>
      
        
        <li class="menu-item menu-item-schedule">
          <a href="/schedule/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-calendar"></i> <br>
            
            æ—¥ç¨‹è¡¨
          </a>
        </li>
      
        
        <li class="menu-item menu-item-sitemap">
          <a href="/sitemap.xml" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-sitemap"></i> <br>
            
            ç«™ç‚¹åœ°å›¾
          </a>
        </li>
      
        
        <li class="menu-item menu-item-commonweal">
          <a href="/404/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-heartbeat"></i> <br>
            
            å…¬ç›Š404
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/11/08/ç¥ç»ç½‘ç»œä¼˜åŒ–/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xuli">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/uploads/yasuo.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="xuyasuoçš„åšå®¢">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">ç¥ç»ç½‘ç»œä¼˜åŒ–</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2019-11-08T21:17:29+08:00">
                2019-11-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="1"><a href="#1" class="headerlink" title="1"></a>1</h2><p><img src="1.png" alt><br><img src="2.png" alt></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"><span class="comment">#é¢„æµ‹å¤šæˆ–é¢„æµ‹å°‘çš„å½±å“ä¸€æ ·</span></span><br><span class="line"><span class="comment">#0å¯¼å…¥æ¨¡å—ï¼Œç”Ÿæˆæ•°æ®é›†</span></span><br><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">BATCH_SIZE = <span class="number">8</span></span><br><span class="line">SEED = <span class="number">23455</span></span><br><span class="line"></span><br><span class="line">rdm = np.random.RandomState(SEED)</span><br><span class="line">X = rdm.rand(<span class="number">32</span>,<span class="number">2</span>)</span><br><span class="line">Y_ = [[x1+x2+(rdm.rand()/<span class="number">10.0</span><span class="number">-0.05</span>)] <span class="keyword">for</span> (x1,x2) <span class="keyword">in</span> X]</span><br><span class="line"></span><br><span class="line"><span class="comment">#1å®šä¹‰ç¥ç»ç½‘ç»œçš„è¾“å…¥ã€å‚æ•°å’Œè¾“å‡ºï¼Œå®šä¹‰å‰å‘ä¼ æ’­è¿‡ç¨‹ã€‚</span></span><br><span class="line">x = tf.placeholder(tf.float32,shape=(<span class="literal">None</span>,<span class="number">2</span>))</span><br><span class="line">y_ = tf.placeholder(tf.float32,shape=(<span class="literal">None</span>,<span class="number">1</span>))</span><br><span class="line">w1 = tf.Variable(tf.random_normal([<span class="number">2</span>,<span class="number">1</span>],stddev=<span class="number">1</span>,seed=<span class="number">1</span>))</span><br><span class="line">y = tf.matmul(x,w1)</span><br><span class="line"></span><br><span class="line"><span class="comment">#2å®šä¹‰æŸå¤±å‡½æ•°åŠåå‘ä¼ æ’­æ–¹æ³•ã€‚</span></span><br><span class="line"><span class="comment">#å®šä¹‰æŸå¤±å‡½æ•°ä¸ºMSEï¼Œåå‘ä¼ æ’­æ–¹æ³•ä¸ºæ¢¯åº¦ä¸‹é™ã€‚</span></span><br><span class="line">loss_mse = tf.reduce_mean(tf.square(y_-y))</span><br><span class="line">train_step = tf.train.GradientDescentOptimizer(<span class="number">0.001</span>).minimize(loss_mse)</span><br><span class="line"></span><br><span class="line"><span class="comment">#ç”Ÿæˆä¼šè¯ï¼Œè®­ç»ƒSTEPSè½®</span></span><br><span class="line"><span class="keyword">with</span> tf.Session() <span class="keyword">as</span> sess:</span><br><span class="line">init_op = tf.global_variables_initializer()</span><br><span class="line">sess.run(init_op)</span><br><span class="line">STEPS = <span class="number">20000</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(STEPS):</span><br><span class="line">start = (i*BATCH_SIZE)%<span class="number">32</span></span><br><span class="line">end = (i*BATCH_SIZE)%<span class="number">32</span> + BATCH_SIZE</span><br><span class="line">sess.run(train_step,feed_dict=&#123;x:X[start:end],y_:Y_[start:end]&#125;)</span><br><span class="line"><span class="keyword">if</span> i %<span class="number">500</span> == <span class="number">0</span>:</span><br><span class="line"><span class="keyword">print</span> <span class="string">"After %d training steps, w1 is"</span>%(i)</span><br><span class="line"><span class="keyword">print</span>  sess.run(w1)</span><br><span class="line"><span class="keyword">print</span>  <span class="string">"Final w1 is:\n"</span>,sess.run(w1)</span><br><span class="line"><span class="comment">#åœ¨æœ¬ä»£ç #2ä¸­å°è¯•å…¶ä»–åå‘ä¼ æ’­æ–¹æ³•ï¼Œçœ‹å¯¹æ”¶æ•›é€Ÿåº¦çš„å½±å“ï¼ŒæŠŠä½“ä¼šå†™åˆ°ç¬”è®°ä¸­</span></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœå¦‚ä¸‹:</p>
<p><img src="3.png" alt></p>
<p>ç”±ä¸Šè¿°ä»£ç å¯çŸ¥ï¼Œæœ¬ä¾‹ä¸­ç¥ç»ç½‘ç»œé¢„æµ‹æ¨¡å‹ä¸º y = w1<em>x1 + w2</em>x2ï¼ŒæŸå¤±å‡½æ•°é‡‡ç”¨å‡æ–¹è¯¯å·®ã€‚é€šè¿‡ä½¿ æŸå¤±å‡½æ•°å€¼(loss)ä¸æ–­é™ä½ï¼Œç¥ç»ç½‘ç»œæ¨¡å‹å¾—åˆ°æœ€ç»ˆå‚æ•° w1=0.98ï¼Œw2=1.02ï¼Œé”€é‡é¢„æµ‹ç»“æœä¸º y = 0.98<em>x1 + 1.02</em>x2ã€‚ç”±äºåœ¨ç”Ÿæˆæ•°æ®é›†æ—¶ï¼Œæ ‡å‡†ç­”æ¡ˆä¸º y = x1 + x2ï¼Œå› æ­¤ï¼Œé”€é‡é¢„æµ‹ç»“æœå’Œæ ‡å‡† ç­”æ¡ˆå·²éå¸¸æ¥è¿‘ï¼Œè¯´æ˜è¯¥ç¥ç»ç½‘ç»œé¢„æµ‹é…¸å¥¶æ—¥é”€é‡æ­£ç¡®ã€‚<br><strong>è‡ªå®šä¹‰æŸå¤±å‡½æ•°:æ ¹æ®é—®é¢˜çš„å®é™…æƒ…å†µï¼Œå®šåˆ¶åˆç†çš„æŸå¤±å‡½æ•°ã€‚</strong></p>
<p>ä¾‹å¦‚: å¯¹äºé¢„æµ‹é…¸å¥¶æ—¥é”€é‡é—®é¢˜ï¼Œå¦‚æœé¢„æµ‹é”€é‡å¤§äºå®é™…é”€é‡åˆ™ä¼šæŸå¤±æˆæœ¬;å¦‚æœé¢„æµ‹é”€é‡å°äºå®é™…é”€é‡åˆ™ ä¼šæŸå¤±åˆ©æ¶¦ã€‚åœ¨å®é™…ç”Ÿæ´»ä¸­ï¼Œå¾€å¾€åˆ¶é€ ä¸€ç›’é…¸å¥¶çš„æˆæœ¬å’Œé”€å”®ä¸€ç›’é…¸å¥¶çš„åˆ©æ¶¦æ˜¯ä¸ç­‰ä»·çš„ã€‚å› æ­¤ï¼Œéœ€ è¦ä½¿ç”¨ç¬¦åˆè¯¥é—®é¢˜çš„è‡ªå®šä¹‰æŸå¤±å‡½æ•°ã€‚<br>è‡ªå®šä¹‰æŸå¤±å‡½æ•°ä¸º:loss = âˆ‘ğ‘›ğ‘“(y_, y)<br>å…¶ä¸­ï¼ŒæŸå¤±å®šä¹‰æˆåˆ†æ®µå‡½æ•°:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">f(y_,y)=ğ‘ƒğ‘…ğ‘‚ğ¹ğ¼ğ‘‡âˆ—(ğ‘¦_âˆ’ğ‘¦) ğ‘¦&lt;ğ‘¦_ </span><br><span class="line">ğ¶ğ‘‚ğ‘†ğ‘‡âˆ—(ğ‘¦âˆ’ğ‘¦_)  ğ‘¦&gt;=ğ‘¦_</span><br></pre></td></tr></table></figure>

<p>æŸå¤±å‡½æ•°è¡¨ç¤ºï¼Œè‹¥é¢„æµ‹ç»“æœ y å°äºæ ‡å‡†ç­”æ¡ˆ y_ï¼ŒæŸå¤±å‡½æ•°ä¸ºåˆ©æ¶¦ä¹˜ä»¥é¢„æµ‹ç»“æœ y ä¸æ ‡å‡†ç­”æ¡ˆ y_ä¹‹å·®; è‹¥é¢„æµ‹ç»“æœ y å¤§äºæ ‡å‡†ç­”æ¡ˆ y_ï¼ŒæŸå¤±å‡½æ•°ä¸ºæˆæœ¬ä¹˜ä»¥é¢„æµ‹ç»“æœ y ä¸æ ‡å‡†ç­”æ¡ˆ y_ä¹‹å·®ã€‚<br>ç”¨ Tensorflow å‡½æ•°è¡¨ç¤ºä¸º:<br>loss = tf.reduce_sum(tf.where(tf.greater(y,y_),COST(y-y_),PROFIT(y_-y)))<br>1 è‹¥é…¸å¥¶æˆæœ¬ä¸º 1 å…ƒï¼Œé…¸å¥¶é”€å”®åˆ©æ¶¦ä¸º 9 å…ƒï¼Œåˆ™åˆ¶é€ æˆæœ¬å°äºé…¸å¥¶åˆ©æ¶¦ï¼Œå› æ­¤å¸Œæœ›é¢„æµ‹çš„ç»“æœ y å¤š<br>ä¸€äº›ã€‚é‡‡ç”¨ä¸Šè¿°çš„è‡ªå®šä¹‰æŸå¤±å‡½æ•°ï¼Œè®­ç»ƒç¥ç»ç½‘ç»œæ¨¡å‹ã€‚<br>ä»£ç å¦‚ä¸‹:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"><span class="comment">#æˆæœ¬9å…ƒï¼Œåˆ©æ¶¦1å…ƒ</span></span><br><span class="line"><span class="comment">#é¢„æµ‹å¤šæˆ–é¢„æµ‹å°‘çš„å½±å“ä¸€æ ·</span></span><br><span class="line"><span class="comment">#0å¯¼å…¥æ¨¡å—ï¼Œç”Ÿæˆæ•°æ®é›†</span></span><br><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">BATCH_SIZE = <span class="number">8</span></span><br><span class="line">SEED = <span class="number">23455</span></span><br><span class="line">COST = <span class="number">9</span></span><br><span class="line">PROFIT = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">rdm = np.random.RandomState(SEED)</span><br><span class="line">X = rdm.rand(<span class="number">32</span>,<span class="number">2</span>)</span><br><span class="line">Y_ = [[x1+x2+(rdm.rand()/<span class="number">10.0</span><span class="number">-0.05</span>)] <span class="keyword">for</span> (x1,x2) <span class="keyword">in</span> X]</span><br><span class="line"></span><br><span class="line"><span class="comment">#1å®šä¹‰ç¥ç»ç½‘ç»œçš„è¾“å…¥ã€å‚æ•°å’Œè¾“å‡ºï¼Œå®šä¹‰å‰å‘ä¼ æ’­è¿‡ç¨‹ã€‚</span></span><br><span class="line">x = tf.placeholder(tf.float32,shape=(<span class="literal">None</span>,<span class="number">2</span>))</span><br><span class="line">y_ = tf.placeholder(tf.float32,shape=(<span class="literal">None</span>,<span class="number">1</span>))</span><br><span class="line">w1 = tf.Variable(tf.random_normal([<span class="number">2</span>,<span class="number">1</span>],stddev=<span class="number">1</span>,seed=<span class="number">1</span>))</span><br><span class="line">y = tf.matmul(x,w1)</span><br><span class="line"></span><br><span class="line"><span class="comment">#2å®šä¹‰æŸå¤±å‡½æ•°åŠåå‘ä¼ æ’­æ–¹æ³•ã€‚</span></span><br><span class="line"><span class="comment">#å®šä¹‰æŸå¤±å‡½æ•°ä½¿å¾—é¢„æµ‹å°‘äº†çš„æŸå¤±å¤§ï¼Œäºæ˜¯åº”è¯¥å‘ä¾¿å¤šçš„æ–¹å‘é¢„æµ‹ã€‚åå‘ä¼ æ’­æ–¹æ³•ä¸ºæ¢¯åº¦ä¸‹é™ã€‚</span></span><br><span class="line">loss_mse = tf.reduce_sum(tf.where(tf.greater(y,y_),(y-y_)*COST,(y_-y)*PROFIT))</span><br><span class="line">train_step = tf.train.GradientDescentOptimizer(<span class="number">0.001</span>).minimize(loss_mse)</span><br><span class="line"></span><br><span class="line"><span class="comment">#ç”Ÿæˆä¼šè¯ï¼Œè®­ç»ƒSTEPSè½®</span></span><br><span class="line"><span class="keyword">with</span> tf.Session() <span class="keyword">as</span> sess:</span><br><span class="line">init_op = tf.global_variables_initializer()</span><br><span class="line">sess.run(init_op)</span><br><span class="line">STEPS = <span class="number">20000</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(STEPS):</span><br><span class="line">start = (i*BATCH_SIZE)%<span class="number">32</span></span><br><span class="line">end = (i*BATCH_SIZE)%<span class="number">32</span> + BATCH_SIZE</span><br><span class="line">sess.run(train_step,feed_dict=&#123;x:X[start:end],y_:Y_[start:end]&#125;)</span><br><span class="line"><span class="keyword">if</span> i %<span class="number">500</span> == <span class="number">0</span>:</span><br><span class="line"><span class="keyword">print</span> <span class="string">"After %d training steps, w1 is"</span>%(i)</span><br><span class="line"><span class="keyword">print</span>  sess.run(w1)</span><br><span class="line"><span class="keyword">print</span>  <span class="string">"Final w1 is:\n"</span>,sess.run(w1)</span><br><span class="line"><span class="comment">#åœ¨æœ¬ä»£ç #2ä¸­å°è¯•å…¶ä»–åå‘ä¼ æ’­æ–¹æ³•ï¼Œçœ‹å¯¹æ”¶æ•›é€Ÿåº¦çš„å½±å“ï¼ŒæŠŠä½“ä¼šå†™åˆ°ç¬”è®°ä¸­</span></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœå¦‚ä¸‹:</p>
<p><img src="4.png" alt></p>
<p><strong>äº¤å‰ç†µ(Cross Entropy):è¡¨ç¤ºä¸¤ä¸ªæ¦‚ç‡åˆ†å¸ƒä¹‹é—´çš„è·ç¦»ã€‚äº¤å‰ç†µè¶Šå¤§ï¼Œä¸¤ä¸ªæ¦‚ç‡åˆ†å¸ƒè·ç¦»è¶Šè¿œï¼Œä¸¤ ä¸ªæ¦‚ç‡åˆ†å¸ƒè¶Šç›¸å¼‚;äº¤å‰ç†µè¶Šå°ï¼Œä¸¤ä¸ªæ¦‚ç‡åˆ†å¸ƒè·ç¦»è¶Šè¿‘ï¼Œä¸¤ä¸ªæ¦‚ç‡åˆ†å¸ƒè¶Šç›¸ä¼¼ã€‚ äº¤å‰ç†µè®¡ç®—å…¬å¼:ğ‡(ğ²_ , ğ²) = âˆ’âˆ‘ğ²_ âˆ— ğ’ğ’ğ’ˆ ğ’š<br>ç”¨ Tensorflow å‡½æ•°è¡¨ç¤ºä¸º</strong><br>ce= -tf.reduce_mean(y_* tf.log(tf.clip_by_value(y, 1e-12, 1.0)))</p>
<p><img src="4.png" alt></p>
<h2 id="2"><a href="#2" class="headerlink" title="2"></a>2</h2><p><strong>å­¦ä¹ ç‡ learning_rate:è¡¨ç¤ºäº†æ¯æ¬¡å‚æ•°æ›´æ–°çš„å¹…åº¦å¤§å°ã€‚å­¦ä¹ ç‡è¿‡å¤§ï¼Œä¼šå¯¼è‡´å¾…ä¼˜åŒ–çš„å‚æ•°åœ¨æœ€ å°å€¼é™„è¿‘æ³¢åŠ¨ï¼Œä¸æ”¶æ•›;å­¦ä¹ ç‡è¿‡å°ï¼Œä¼šå¯¼è‡´å¾…ä¼˜åŒ–çš„å‚æ•°æ”¶æ•›ç¼“æ…¢ã€‚ åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œå‚æ•°çš„æ›´æ–°å‘ç€æŸå¤±å‡½æ•°æ¢¯åº¦ä¸‹é™çš„æ–¹å‘ã€‚<br>å‚æ•°çš„æ›´æ–°å…¬å¼ä¸º:<br>ğ’˜ğ’+ğŸ = ğ’˜ğ’ âˆ’ ğ’ğ’†ğ’‚ğ’“ğ’ğ’Šğ’ğ’ˆ_ğ’“ğ’‚ğ’•ğ’†ğ›</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"><span class="comment">#è®¾æŸå¤±å‡½æ•° loss=(w+1)^2,ä»¤wåˆå€¼æ˜¯å¸¸æ•°5ã€‚åå‘ä¼ æ’­å°±æ˜¯æ±‚æœ€ä¼˜wï¼Œå³æ±‚æœ€å°losså¯¹åº”çš„wå€¼</span></span><br><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"><span class="comment">#å®šä¹‰å¾…ä¼˜åŒ–å‚æ•°wåˆå€¼5</span></span><br><span class="line">w = tf.Variable(tf.constant(<span class="number">5</span>,dtype=tf.float32))</span><br><span class="line"><span class="comment">#å®šä¹‰æŸå¤±å‡½æ•°loss</span></span><br><span class="line">loss = tf.square(w+<span class="number">1</span>)</span><br><span class="line"><span class="comment">#å®šä¹‰åå‘ä¼ æ’­æ–¹æ³•</span></span><br><span class="line">train_step = tf.train.GradientDescentOptimizer(<span class="number">0.2</span>).minimize(loss)</span><br><span class="line"><span class="comment">#ç”Ÿæˆä¼šè¯ï¼Œè®­ç»ƒ40è½®</span></span><br><span class="line"><span class="keyword">with</span> tf.Session() <span class="keyword">as</span> sess:</span><br><span class="line">init_op = tf.global_variables_initializer()</span><br><span class="line">sess.run(init_op)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">40</span>):</span><br><span class="line">sess.run(train_step)</span><br><span class="line">w_val = sess.run(w)</span><br><span class="line">loss_val = sess.run(loss)</span><br><span class="line"><span class="keyword">print</span> <span class="string">"After %s steps: w is %f.   loss is %f"</span> % (i, w_val,loss_val)</span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœå¦‚ä¸‹:<br><img src="5.png" alt><br>ç”±ç»“æœå¯çŸ¥ï¼Œéšç€æŸå¤±å‡½æ•°å€¼çš„å‡å°ï¼Œw æ— é™è¶‹è¿‘äº-1ï¼Œæ¨¡å‹è®¡ç®—æ¨æµ‹å‡ºæœ€ä¼˜å‚æ•° w = -1ã€‚<br><strong>å­¦ä¹ ç‡çš„è®¾ç½® å­¦ä¹ ç‡è¿‡å¤§ï¼Œä¼šå¯¼è‡´å¾…ä¼˜åŒ–çš„å‚æ•°åœ¨æœ€å°å€¼é™„è¿‘æ³¢åŠ¨ï¼Œä¸æ”¶æ•›;å­¦ä¹ ç‡è¿‡å°ï¼Œä¼šå¯¼è‡´å¾…ä¼˜åŒ–çš„å‚æ•°æ”¶ æ•›ç¼“æ…¢ã€‚</strong></p>
<p><strong>æŒ‡æ•°è¡°å‡å­¦ä¹ ç‡:å­¦ä¹ ç‡éšç€è®­ç»ƒè½®æ•°å˜åŒ–è€ŒåŠ¨æ€æ›´æ–°</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"><span class="comment">#è®¾æŸå¤±å‡½æ•° loss=(w+1)^2,ä»¤wåˆå€¼æ˜¯å¸¸æ•°10ã€‚åå‘ä¼ æ’­å°±æ˜¯æ±‚æœ€ä¼˜wï¼Œå³æ±‚æœ€å°losså¯¹åº”çš„wå€¼</span></span><br><span class="line"><span class="comment">#ä½¿ç”¨æŒ‡æ•°è¡°å‡çš„å­¦ä¹ ç‡ï¼Œåœ¨è¿­ä»£åˆæœŸå¾—åˆ°è¾ƒé«˜çš„ä¸‹é™é€Ÿåº¦ï¼Œå¯ä»¥åœ¨è¾ƒå°çš„è®­ç»ƒè½®æ•°ä¸‹å–çš„æ›´ä¼˜æ”¶æ•›åº¦</span></span><br><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"></span><br><span class="line">LEARNING_RATE_BASE = <span class="number">0.1</span> <span class="comment">#æœ€åˆå­¦ä¹ ç‡</span></span><br><span class="line">LEARNING_RATE_DECAY = <span class="number">0.99</span> <span class="comment">#å­¦ä¹ ç‡è¡°å‡ç‡</span></span><br><span class="line">LEARNING_RATE_STEP = <span class="number">1</span> <span class="comment">#å–‚å…¥å¤šå°‘è½®BATCH_SIZEåï¼Œæ›´æ–°ä¸€æ¬¡å­¦ä¹ ç‡ï¼Œä¸€èˆ¬è®¾ä¸ºï¼šæ€»æ ·æœ¬æ•°/BATCH_SIZE</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#è¿è¡Œäº†å‡ è½®BATCH_SIZEçš„è®¡æ•°å™¨ï¼Œåˆå€¼ç»™0ï¼Œè®¾ä¸ºä¸è¢«è®­ç»ƒ</span></span><br><span class="line">global_step = tf.Variable(<span class="number">0</span>,trainable=<span class="literal">False</span>)</span><br><span class="line"><span class="comment">#å®šä¹‰æŒ‡æ•°ä¸‹é™å­¦ä¹ ç‡</span></span><br><span class="line">learning_rate = tf.train.exponential_decay(LEARNING_RATE_BASE,global_step,LEARNING_RATE_STEP,LEARNING_RATE_DECAY,</span><br><span class="line">staircase=<span class="literal">True</span>)</span><br><span class="line"><span class="comment">#å®šä¹‰å¾…ä¼˜åŒ–å‚æ•°ï¼Œåˆå€¼ç»™10</span></span><br><span class="line">w = tf.Variable(tf.constant(<span class="number">5</span>,dtype=tf.float32))</span><br><span class="line"><span class="comment">#å®šä¹‰æŸå¤±å‡½æ•°loss</span></span><br><span class="line">loss = tf.square(w+<span class="number">1</span>)</span><br><span class="line"><span class="comment">#å®šä¹‰åå‘ä¼ æ’­æ–¹æ³•</span></span><br><span class="line">train_step = tf.train.GradientDescentOptimizer(learning_rate).minimize(loss,global_step=global_step)</span><br><span class="line"><span class="comment">#ç”Ÿæˆä¼šè¯ï¼Œè®­ç»ƒ40è½®</span></span><br><span class="line"><span class="keyword">with</span> tf.Session() <span class="keyword">as</span> sess:</span><br><span class="line">init_op = tf.global_variables_initializer()</span><br><span class="line">sess.run(init_op)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">40</span>):</span><br><span class="line">sess.run(train_step)</span><br><span class="line">learning_rate_val = sess.run(learning_rate)</span><br><span class="line">global_step_val = sess.run(global_step)</span><br><span class="line">w_val = sess.run(w)</span><br><span class="line">loss_val = sess.run(loss)</span><br><span class="line"><span class="keyword">print</span> <span class="string">"After %s steps: global_step is %f , learning rate is %f, w is %f.   loss is %f"</span> % (i,global_step_val,learning_rate_val, w_val,loss_val)</span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœå¦‚ä¸‹:<br><img src="6.png" alt><br>ç”±ç»“æœå¯ä»¥çœ‹å‡ºï¼Œéšç€è®­ç»ƒè½®æ•°å¢åŠ å­¦ä¹ ç‡åœ¨ä¸æ–­å‡å°ã€‚</p>
<h2 id="3"><a href="#3" class="headerlink" title="3"></a>3</h2><p>æ»‘åŠ¨å¹³å‡:è®°å½•äº†ä¸€æ®µæ—¶é—´å†…æ¨¡å‹ä¸­æ‰€æœ‰å‚æ•° w å’Œ b å„è‡ªçš„å¹³å‡å€¼ã€‚åˆ©ç”¨æ»‘åŠ¨å¹³å‡å€¼å¯ä»¥å¢å¼ºæ¨¡ å‹çš„æ³›åŒ–èƒ½åŠ›ã€‚<br>æ»‘åŠ¨å¹³å‡å€¼(å½±å­)è®¡ç®—å…¬å¼:<br>å½±å­ = è¡°å‡ç‡ * å½±å­ +(1 - è¡°å‡ç‡)* å‚æ•°<br>å…¶ä¸­ï¼Œè¡°å‡ç‡ = ğ¦ğ¢ğ§ {ğ‘´ğ‘¶ğ‘½ğ‘°ğ‘µğ‘®ğ‘¨ğ‘½ğ‘¬ğ‘¹ğ‘¨ğ‘®ğ‘¬ğ‘«ğ‘¬ğ‘ªğ‘¨ğ’€ , ğŸ+è½®æ•° /10+è½®æ•°}ï¼Œå½±å­åˆå€¼=å‚æ•°åˆå€¼<br>âˆšç”¨ Tesnsorflow å‡½æ•°è¡¨ç¤ºä¸º:<br>âˆšema = tf.train.ExponentialMovingAverage(MOVING_AVERAGE_DECAYï¼Œglobal_step) å…¶ä¸­ï¼ŒMOVING_AVERAGE_DECAY è¡¨ç¤ºæ»‘åŠ¨å¹³å‡è¡°å‡ç‡ï¼Œä¸€èˆ¬ä¼šèµ‹æ¥è¿‘ 1 çš„å€¼ï¼Œglobal_step è¡¨ç¤ºå½“å‰ è®­ç»ƒäº†å¤šå°‘è½®ã€‚<br>âˆšema_op = ema.apply(tf.trainable_variables()) å…¶ä¸­ï¼Œema.apply()å‡½æ•°å®ç°å¯¹æ‹¬å·å†…å‚æ•°æ±‚æ»‘åŠ¨å¹³å‡ï¼Œtf.trainable_variables()å‡½æ•°å®ç°æŠŠæ‰€æœ‰ å¾…è®­ç»ƒå‚æ•°æ±‡æ€»ä¸ºåˆ—è¡¨ã€‚<br>âˆšwith tf.control_dependencies([train_step, ema_op]):<br>train_op = tf.no_op(name=â€™trainâ€™)<br>å…¶ä¸­ï¼Œè¯¥å‡½æ•°å®ç°å°†æ»‘åŠ¨å¹³å‡å’Œè®­ç»ƒè¿‡ç¨‹åŒæ­¥è¿è¡Œã€‚<br>æŸ¥çœ‹æ¨¡å‹ä¸­å‚æ•°çš„å¹³å‡å€¼ï¼Œå¯ä»¥ç”¨ ema.average()å‡½æ•°ã€‚<br>ä¾‹å¦‚:<br>åœ¨ç¥ç»ç½‘ç»œæ¨¡å‹ä¸­ï¼Œå°† MOVING_AVERAGE_DECAY è®¾ç½®ä¸º 0.99ï¼Œå‚æ•° w1 è®¾ç½®ä¸º 0ï¼Œw1 çš„æ»‘åŠ¨å¹³å‡å€¼è®¾ ç½®ä¸º 0ã€‚<br>1å¼€å§‹æ—¶ï¼Œè½®æ•° global_step è®¾ç½®ä¸º 0ï¼Œå‚æ•° w1 æ›´æ–°ä¸º 1ï¼Œåˆ™ w1 çš„æ»‘åŠ¨å¹³å‡å€¼ä¸º:<br>w1 æ»‘åŠ¨å¹³å‡å€¼=min(0.99,1/10)<em>0+(1â€“ min(0.99,1/10)</em>1 = 0.9<br>3 å½“è½®æ•° global_step è®¾ç½®ä¸º 100 æ—¶ï¼Œå‚æ•° w1 æ›´æ–°ä¸º 10ï¼Œä»¥ä¸‹ä»£ç  global_step ä¿æŒä¸º 100ï¼Œæ¯<br>æ¬¡æ‰§è¡Œæ»‘åŠ¨å¹³å‡æ“ä½œå½±å­å€¼æ›´æ–°ï¼Œåˆ™æ»‘åŠ¨å¹³å‡å€¼å˜ä¸º:<br>w1 æ»‘åŠ¨å¹³å‡å€¼=min(0.99,101/110)<em>0.9+(1â€“ min(0.99,101/110)</em>10 = 0.826+0.818=1.644 3å†æ¬¡è¿è¡Œï¼Œå‚æ•° w1 æ›´æ–°ä¸º 1.644ï¼Œåˆ™æ»‘åŠ¨å¹³å‡å€¼å˜ä¸º:<br>w1 æ»‘åŠ¨å¹³å‡å€¼=min(0.99,101/110)<em>1.644+(1â€“ min(0.99,101/110)</em>10 = 2.328 4å†æ¬¡è¿è¡Œï¼Œå‚æ•° w1 æ›´æ–°ä¸º 2.328ï¼Œåˆ™æ»‘åŠ¨å¹³å‡å€¼:<br>w1 æ»‘åŠ¨å¹³å‡å€¼=2.956<br>ä»£ç å¦‚ä¸‹:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"></span><br><span class="line"><span class="comment">#1. å®šä¹‰å˜é‡åŠæ»‘åŠ¨å¹³å‡ç±»</span></span><br><span class="line"><span class="comment">#å®šä¹‰ä¸€ä¸ª32ä½æµ®ç‚¹å˜é‡ï¼Œåˆå§‹å€¼ä½0.0  è¿™ä¸ªä»£ç å°±æ˜¯ä¸æ–­æ›´æ–°w1å‚æ•°ï¼Œä¼˜åŒ–w1å‚æ•°æ»‘åŠ¨å¹³å‡åšäº†ä¸€ä¸ªw1çš„å½±å­</span></span><br><span class="line">w1 = tf.Variable(<span class="number">0</span>,dtype=tf.float32)</span><br><span class="line"><span class="comment">#å®šä¹‰num_updates(NNçš„è¿­ä»£è½®æ•°)ï¼Œåˆå§‹å€¼ä½0ï¼Œä¸å¯è¢«ä¼˜åŒ–ï¼ˆè®­ç»ƒï¼‰ï¼Œè¿™ä¸ªå‚æ•°ä¸è®­ç»ƒ</span></span><br><span class="line">global_step = tf.Variable(<span class="number">0</span>,trainable=<span class="literal">False</span>)</span><br><span class="line"><span class="comment">#å®ä¾‹åŒ–æ»‘åŠ¨å¹³å‡ç±»ï¼Œç»™åˆ å‡ç‡ä¸º0ã€‚99ï¼Œå½“å‰è½®æ•°global_step</span></span><br><span class="line">MOVING_AVERAGE_DECAY = <span class="number">0.99</span></span><br><span class="line">ema = tf.train.ExponentialMovingAverage(MOVING_AVERAGE_DECAY,global_step)</span><br><span class="line"><span class="comment">#ema.applyåçš„æ‹¬å·é‡Œæ˜¯æ›´æ–°åˆ—è¡¨ï¼Œæ¯æ¬¡è¿è¡Œsess.run(ema_op)æ—¶ï¼Œå¯¹æ›´æ–°åˆ—è¡¨ä¸­çš„å…ƒç´ æ±‚æ»‘åŠ¨å¹³å‡å€¼ã€‚</span></span><br><span class="line"><span class="comment">#åœ¨å®é™…åº”ç”¨ä¸­ä¼šä½¿ç”¨tf.trainble_variable()è‡ªåŠ¨å°†æ‰€æœ‰å¾…è®­ç»ƒçš„å‚æ•°æ±‡æ€»ä¸ºåˆ—è¡¨</span></span><br><span class="line"><span class="comment">#ema_op = em.apply([w1])</span></span><br><span class="line">ema_op = ema.apply(tf.trainable_variables())</span><br><span class="line"></span><br><span class="line"><span class="comment">#2. æŸ¥çœ‹ä¸åŒè¿­ä»£ä¸­å˜é‡å–å€¼çš„å˜åŒ–ã€‚</span></span><br><span class="line"><span class="keyword">with</span> tf.Session() <span class="keyword">as</span> sess:</span><br><span class="line"><span class="comment">#åˆå§‹åŒ–</span></span><br><span class="line">init_op = tf.global_variables_initializer()</span><br><span class="line">sess.run(init_op)</span><br><span class="line"><span class="comment">#ç”¨ema.average(w1)è·å–w1æ»‘åŠ¨å¹³å‡å€¼  ï¼ˆè¦è¿è¡Œå¤šä¸ªèŠ‚ç‚¹ï¼Œä½œä¸ºåˆ—è¡¨ä¸­çš„å…ƒç´ åˆ—å‡ºï¼Œå†™åœ¨sess.runä¸­ï¼‰</span></span><br><span class="line"><span class="keyword">print</span> sess.run([w1,ema.average(w1)])</span><br><span class="line"></span><br><span class="line"><span class="comment"># å‚æ•°w1çš„å€¼èµ‹ä¸º1</span></span><br><span class="line">sess.run(tf.assign(w1, <span class="number">1</span>))</span><br><span class="line">sess.run(ema_op)</span><br><span class="line"><span class="keyword">print</span> sess.run([w1,ema.average(w1)])</span><br><span class="line"></span><br><span class="line"><span class="comment">#æ›´æ–°stepå’Œw1çš„å€¼ï¼Œæ¨¡æ‹Ÿå‡º100è½®è¿­ä»£åï¼Œå‚æ•°w1å˜åŒ–ä¸º10</span></span><br><span class="line">sess.run(tf.assign(global_step,<span class="number">100</span>))</span><br><span class="line">sess.run(tf.assign(w1,<span class="number">10</span>))</span><br><span class="line">sess.run(ema_op)</span><br><span class="line"><span class="keyword">print</span> sess.run([w1,ema.average(w1)])</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¯æ¬¡sess.runä¼šæ›´æ–°ä¸€æ¬¡w1çš„æ»‘åŠ¨å¹³å‡å€¼</span></span><br><span class="line">sess.run(ema_op)</span><br><span class="line"><span class="keyword">print</span> sess.run([w1, ema.average(w1)])</span><br><span class="line"></span><br><span class="line">sess.run(ema_op)</span><br><span class="line"><span class="keyword">print</span> sess.run([w1, ema.average(w1)])</span><br><span class="line"></span><br><span class="line">sess.run(ema_op)</span><br><span class="line"><span class="keyword">print</span> sess.run([w1,ema.average(w1)])</span><br><span class="line"></span><br><span class="line">sess.run(ema_op)</span><br><span class="line"><span class="keyword">print</span> sess.run([w1, ema.average(w1)])</span><br><span class="line"></span><br><span class="line">sess.run(ema_op)</span><br><span class="line"><span class="keyword">print</span> sess.run([w1, ema.average(w1)])</span><br><span class="line"></span><br><span class="line">sess.run(ema_op)</span><br><span class="line"><span class="keyword">print</span> sess.run([w1, ema.average(w1)])</span><br><span class="line"></span><br><span class="line"><span class="comment">#æ›´æ”¹MOVING_AVERAGE_DECAY ä¸º 0.1 çœ‹å½±å­è¿½éšé€Ÿåº¦</span></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç¨‹åºï¼Œç»“æœå¦‚ä¸‹:<br><img src="7.png" alt></p>
<p>ä»è¿è¡Œç»“æœå¯çŸ¥ï¼Œæœ€åˆå‚æ•° w1 å’Œæ»‘åŠ¨å¹³å‡å€¼éƒ½æ˜¯ 0;å‚æ•° w1 è®¾å®šä¸º 1 åï¼Œæ»‘åŠ¨å¹³å‡å€¼å˜ä¸º 0.9; å½“è¿­ä»£è½®æ•°æ›´æ–°ä¸º 100 è½®æ—¶ï¼Œå‚æ•° w1 æ›´æ–°ä¸º 10 åï¼Œæ»‘åŠ¨å¹³å‡å€¼å˜ä¸º 1.644ã€‚éšåæ¯æ‰§è¡Œä¸€æ¬¡ï¼Œå‚æ•° w1 çš„æ»‘åŠ¨å¹³å‡å€¼éƒ½å‘å‚æ•° w1 é è¿‘ã€‚å¯è§ï¼Œæ»‘åŠ¨å¹³å‡è¿½éšå‚æ•°çš„å˜åŒ–è€Œå˜åŒ–ã€‚</p>
<h2 id="4"><a href="#4" class="headerlink" title="4"></a>4</h2><p>âˆšè¿‡æ‹Ÿåˆ:ç¥ç»ç½‘ç»œæ¨¡å‹åœ¨è®­ç»ƒæ•°æ®é›†ä¸Šçš„å‡†ç¡®ç‡è¾ƒé«˜ï¼Œåœ¨æ–°çš„æ•°æ®è¿›è¡Œé¢„æµ‹æˆ–åˆ†ç±»æ—¶å‡†ç¡®ç‡è¾ƒ ä½ï¼Œè¯´æ˜æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›å·®ã€‚<br>âˆšæ­£åˆ™åŒ–:åœ¨æŸå¤±å‡½æ•°ä¸­ç»™æ¯ä¸ªå‚æ•° w åŠ ä¸Šæƒé‡ï¼Œå¼•å…¥æ¨¡å‹å¤æ‚åº¦æŒ‡æ ‡ï¼Œä»è€ŒæŠ‘åˆ¶æ¨¡å‹å™ªå£°ï¼Œå‡å° è¿‡æ‹Ÿåˆã€‚<br>ä½¿ç”¨æ­£åˆ™åŒ–åï¼ŒæŸå¤±å‡½æ•° loss å˜ä¸ºä¸¤é¡¹ä¹‹å’Œ:<br><code>loss = loss(y ä¸ y_) + REGULARIZER*loss(w)</code>å…¶ä¸­ï¼Œç¬¬ä¸€é¡¹æ˜¯é¢„æµ‹ç»“æœä¸æ ‡å‡†ç­”æ¡ˆä¹‹é—´çš„å·®è·ï¼Œå¦‚ä¹‹å‰è®²è¿‡çš„äº¤å‰ç†µã€å‡æ–¹è¯¯å·®ç­‰;ç¬¬äºŒé¡¹æ˜¯æ­£åˆ™<br>åŒ–è®¡ç®—ç»“æœã€‚<br>âˆšæ­£åˆ™åŒ–è®¡ç®—æ–¹æ³•:<br>1 L1 æ­£åˆ™åŒ–: ğ’ğ’ğ’”ğ’”ğ‘³ğŸ = âˆ‘ğ’Š|ğ’˜ğ’Š|<br>ç”¨ Tesnsorflow å‡½æ•°è¡¨ç¤º:loss(w) = tf.contrib.layers.l1_regularizer(REGULARIZER)(w) 2 L2 æ­£åˆ™åŒ–: ğ’ğ’ğ’”ğ’”ğ‘³ğŸ = âˆ‘ğ’Š|ğ’˜ğ’Š|ğŸ<br>ç”¨ Tesnsorflow å‡½æ•°è¡¨ç¤º:loss(w) = tf.contrib.layers.l2_regularizer(REGULARIZER)(w) âˆšç”¨ Tesnsorflow å‡½æ•°å®ç°æ­£åˆ™åŒ–:<br>tf.add_to_collection(â€˜lossesâ€™, tf.contrib.layers.l2_regularizer(regularizer)(w) loss = cem + tf.add_n(tf.get_collection(â€˜lossesâ€™))</p>
<p>âˆšmatplotlib æ¨¡å—:Python ä¸­çš„å¯è§†åŒ–å·¥å…·æ¨¡å—ï¼Œå®ç°å‡½æ•°å¯è§†åŒ– ç»ˆç«¯å®‰è£…æŒ‡ä»¤:sudo pip install matplotlib<br>âˆšå‡½æ•° plt.scatter():åˆ©ç”¨æŒ‡å®šé¢œè‰²å®ç°ç‚¹(x,y)çš„å¯è§†åŒ– plt.scatter (x åæ ‡, y åæ ‡, c=â€é¢œè‰²â€)<br>plt.show()<br>âˆšæ”¶é›†è§„å®šåŒºåŸŸå†…æ‰€æœ‰çš„ç½‘æ ¼åæ ‡ç‚¹:<br>xx, yy = np.mgrid[èµ·:æ­¢:æ­¥é•¿, èµ·:æ­¢:æ­¥é•¿] #æ‰¾åˆ°è§„å®šåŒºåŸŸä»¥æ­¥é•¿ä¸ºåˆ†è¾¨ç‡çš„è¡Œåˆ—ç½‘æ ¼åæ ‡ç‚¹ grid = np.c_[xx.ravel(), yy.ravel()] #æ”¶é›†è§„å®šåŒºåŸŸå†…æ‰€æœ‰çš„ç½‘æ ¼åæ ‡ç‚¹ âˆšplt.contour()å‡½æ•°:å‘ŠçŸ¥ xã€y åæ ‡å’Œå„ç‚¹é«˜åº¦ï¼Œç”¨ levels æŒ‡å®šé«˜åº¦çš„ç‚¹æä¸Šé¢œè‰² plt.contour (x è½´åæ ‡å€¼, y è½´åæ ‡å€¼, è¯¥ç‚¹çš„é«˜åº¦, levels=[ç­‰é«˜çº¿çš„é«˜åº¦])<br>plt.show()</p>
<p>ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding:utf-8</span></span><br><span class="line"><span class="comment"># 0 å¯¼å…¥æ¨¡å—ï¼Œç”Ÿæˆæ¨¡æ‹Ÿæ•°æ®é›†</span></span><br><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line">BATCH_SIZE = <span class="number">30</span></span><br><span class="line">seed = <span class="number">2</span></span><br><span class="line"><span class="comment"># åŸºäºseedäº§ç”Ÿéšæœºæ•°</span></span><br><span class="line">rdm = np.random.RandomState(seed)</span><br><span class="line"><span class="comment"># éšæœºæ•°è¿”å›300è¡Œ2åˆ—çš„çŸ©é˜µï¼Œè¡¨ç¤º300ç»„åæ ‡ç‚¹x0,x1ï¼‰ä½œä¸ºè¾“å…¥æ•°æ®é›†</span></span><br><span class="line">X = rdm.randn(<span class="number">300</span>,<span class="number">2</span>)</span><br><span class="line"><span class="comment"># ä»Xè¿™ä¸ª300è¡Œ2åˆ—çš„çŸ©é˜µä¸­å–å‡ºä¸€è¡Œï¼Œåˆ¤æ–­å¦‚æœä¸¤ä¸ªåæ ‡çš„å¹³æ–¹å’Œå°äº2ï¼Œç»™Yèµ‹å€¼1ï¼Œå…¶ä½™èµ‹å€¼0</span></span><br><span class="line"><span class="comment"># ä½œä¸ºè¾“å…¥æ•°æ®é›†çš„æ ‡ç­¾ï¼ˆæ­£ç¡®ç­”æ¡ˆï¼‰</span></span><br><span class="line">Y_ = [int(x0*x0 + x1*x1 &lt;<span class="number">2</span>) <span class="keyword">for</span> (x0,x1) <span class="keyword">in</span> X]</span><br><span class="line"><span class="comment"># éå†Yä¸­çš„æ¯ä¸ªå…ƒç´ ï¼Œ1èµ‹å€¼'red'å…¶ä½™èµ‹å€¼'blue'ï¼Œè¿™æ ·å¯è§†åŒ–æ˜¾ç¤ºæ—¶äººå¯ä»¥ç›´è§‚åŒºåˆ†</span></span><br><span class="line">Y_c = [[<span class="string">'red'</span> <span class="keyword">if</span> y <span class="keyword">else</span> <span class="string">'blue'</span>] <span class="keyword">for</span> y <span class="keyword">in</span> Y_]</span><br><span class="line"><span class="comment"># å¯¹æ•°æ®é›†Xå’Œæ ‡ç­¾Yè¿›è¡Œshapeæ•´ç†ï¼Œç¬¬ä¸€ä¸ªå…ƒç´ ä¸º-1è¡¨ç¤ºï¼Œéšç¬¬äºŒä¸ªå‚æ•°è®¡ç®—å¾—åˆ°ï¼Œç¬¬äºŒä¸ªå…ƒç´ è¡¨ç¤ºå¤šå°‘åˆ—ï¼ŒæŠŠXæ•´ç†ä¸ºnè¡Œ2åˆ—ï¼ŒæŠŠYæ•´ç†ä¸ºnè¡Œ1åˆ—</span></span><br><span class="line">X = np.vstack(X).reshape(<span class="number">-1</span>,<span class="number">2</span>)</span><br><span class="line">Y_ = np.vstack(Y_).reshape(<span class="number">-1</span>,<span class="number">1</span>)</span><br><span class="line"><span class="keyword">print</span> X</span><br><span class="line"><span class="keyword">print</span> Y_</span><br><span class="line"><span class="keyword">print</span> Y_c</span><br><span class="line"><span class="comment"># ç”¨plt.scatterç”»å‡ºæ•°æ®é›†Xå„è¡Œä¸­ç¬¬0åˆ—å…ƒç´ å’Œç¬¬ä¸€åˆ—å…ƒç´ çš„ç‚¹å³å„è¡Œçš„ï¼ˆx0ï¼Œx1ï¼‰ï¼Œç”¨å„è¡ŒY_cå¯¹åº”çš„å€¼è¡¨ç¤ºé¢œè‰²ï¼ˆcæ˜¯colorçš„ç¼©å†™ï¼‰</span></span><br><span class="line">plt.scatter(X[:,<span class="number">0</span>],X[:,<span class="number">1</span>],c=np.squeeze(Y_c))</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line"><span class="comment">#å®šä¹‰ç¥ç»ç½‘ç»œçš„è¾“å…¥ã€å‚æ•°å’Œè¾“å‡ºï¼Œå®šä¹‰å‰å‘ä¼ æ’­è¿‡ç¨‹</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_weight</span><span class="params">(shape,regularizer)</span>:</span></span><br><span class="line">w = tf.Variable(tf.random_normal(shape),dtype=tf.float32)</span><br><span class="line">tf.add_to_collection(<span class="string">'losses'</span>,tf.contrib.layers.l2_regularizer(regularizer)(w))</span><br><span class="line"><span class="keyword">return</span> w</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_bias</span><span class="params">(shape)</span>:</span></span><br><span class="line">b = tf.Variable(tf.constant(<span class="number">0.01</span>,shape=shape))</span><br><span class="line"><span class="keyword">return</span> b</span><br><span class="line"></span><br><span class="line">x = tf.placeholder(tf.float32,shape=(<span class="literal">None</span>,<span class="number">2</span>))</span><br><span class="line">y_ = tf.placeholder(tf.float32,shape=(<span class="literal">None</span>,<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">w1 = get_weight([<span class="number">2</span>,<span class="number">11</span>],<span class="number">0.01</span>)</span><br><span class="line">b1 = get_bias([<span class="number">11</span>])</span><br><span class="line">y1 = tf.nn.relu(tf.matmul(x,w1)+b1)</span><br><span class="line"></span><br><span class="line">w2 = get_weight([<span class="number">11</span>,<span class="number">1</span>],<span class="number">0.01</span>)</span><br><span class="line">b2 = get_bias([<span class="number">1</span>])</span><br><span class="line">y = tf.matmul(y1,w2)+b2 <span class="comment">#è¾“å‡ºå±‚ä¸è¿‡æ¿€æ´»</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#å®šä¹‰æŸå¤±å‡½æ•°</span></span><br><span class="line">loss_mse = tf.reduce_mean(tf.square(y-y_))        <span class="comment">#å‡æ–¹è¯¯å·®çš„æŸå¤±å‡½æ•°</span></span><br><span class="line">loss_total = loss_mse + tf.add_n(tf.get_collection(<span class="string">'losses'</span>))   <span class="comment">#å‡æ–¹è¯¯å·®çš„æŸå¤±å‡½æ•°åŠ ä¸Šæ¯ä¸€ä¸ªæ­£åˆ™åŒ–wçš„æŸå¤±</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#å®šä¹‰åå‘ä¼ æ’­æ–¹æ³•ï¼šä¸å«æ­£åˆ™åŒ–</span></span><br><span class="line">train_step = tf.train.AdamOptimizer(<span class="number">0.0001</span>).minimize(loss_mse)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> tf.Session() <span class="keyword">as</span> sess:</span><br><span class="line">init_op = tf.global_variables_initializer()</span><br><span class="line">sess.run(init_op)</span><br><span class="line">STEPS = <span class="number">40000</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(STEPS):</span><br><span class="line">start = (i*BATCH_SIZE)%<span class="number">300</span></span><br><span class="line">end = start+BATCH_SIZE</span><br><span class="line">sess.run(train_step,feed_dict=&#123;x:X[start:end],y_:Y_[start:end]&#125;)</span><br><span class="line"><span class="keyword">if</span> i % <span class="number">2000</span> ==<span class="number">0</span>:</span><br><span class="line">loss_mse_v = sess.run(loss_mse,feed_dict=&#123;x:X,y_:Y_&#125;)</span><br><span class="line"><span class="keyword">print</span> (<span class="string">"After %d steps, loss is %f"</span>%(i,loss_mse_v))</span><br><span class="line"><span class="comment"># xxåœ¨ -3åˆ°3ä¹‹é—´ä»¥æ­¥é•¿ä¸º0ã€‚01ï¼Œyyåœ¨ -3åˆ°3ä¹‹é—´ä»¥æ­¥é•¿0ã€‚01ï¼Œç”ŸæˆäºŒç»´ç½‘æ ¼åæ ‡ç‚¹</span></span><br><span class="line">xx,yy = np.mgrid[<span class="number">-3</span>:<span class="number">3</span>:<span class="number">0.01</span>,<span class="number">-3</span>:<span class="number">3</span>:<span class="number">0.01</span>]</span><br><span class="line"><span class="comment">#å°†xxï¼Œyyæ‹‰ç›´ï¼Œå¹¶åˆå¹¶æˆä¸€ä¸ª2åˆ—çš„çŸ©é˜µï¼Œå¾—åˆ°ä¸€ä¸ªç½‘æ ¼åæ ‡ç‚¹çš„é›†åˆ</span></span><br><span class="line">grid = np.c_[xx.ravel(),yy.ravel()]</span><br><span class="line"><span class="comment">#å°†ç½‘æ ¼åæ ‡ç‚¹å–‚å…¥ç¥ç»ç½‘ç»œï¼Œprobsä¸ºè¾“å‡º</span></span><br><span class="line">probs = sess.run(y,feed_dict=&#123;x:grid&#125;)</span><br><span class="line"><span class="comment">#probsçš„shapeè°ƒæ•´æˆxxçš„æ ·å­</span></span><br><span class="line">probs = probs.reshape(xx.shape)</span><br><span class="line"><span class="keyword">print</span> <span class="string">"w1:\n"</span>,sess.run(w1)</span><br><span class="line"><span class="keyword">print</span> <span class="string">"b1:\n"</span>,sess.run(b1)</span><br><span class="line"><span class="keyword">print</span> <span class="string">"w2:\n"</span>,sess.run(w2)</span><br><span class="line"><span class="keyword">print</span> <span class="string">"b2:\n"</span>,sess.run(b2)</span><br><span class="line"></span><br><span class="line">plt.scatter(X[:,<span class="number">0</span>],X[:,<span class="number">1</span>],c=np.squeeze(Y_c))</span><br><span class="line">plt.contour(xx,yy,probs,levels=[<span class="number">0.5</span>])</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#å®šä¹‰åå‘ä¼ æ’­æ–¹æ³•ï¼šåŒ…å«æ­£åˆ™åŒ–</span></span><br><span class="line">train_step = tf.train.AdamOptimizer(<span class="number">0.0001</span>).minimize(loss_total)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> tf.Session() <span class="keyword">as</span> sess:</span><br><span class="line">init_op = tf.global_variables_initializer()</span><br><span class="line">sess.run(init_op)</span><br><span class="line">STEPS = <span class="number">40000</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(STEPS):</span><br><span class="line">start = (i*BATCH_SIZE) % <span class="number">300</span></span><br><span class="line">end = start+BATCH_SIZE</span><br><span class="line">sess.run(train_step,feed_dict=&#123;x:X[start:end],y_:Y_[start:end]&#125;)</span><br><span class="line"><span class="keyword">if</span> i % <span class="number">2000</span> ==<span class="number">0</span>:</span><br><span class="line">loss_v = sess.run(loss_total,feed_dict=&#123;x:X,y_:Y_&#125;)</span><br><span class="line"><span class="keyword">print</span> (<span class="string">"After %d steps, loss is: %f"</span>%(i,loss_v))</span><br><span class="line"></span><br><span class="line">xx,yy = np.mgrid[<span class="number">-3</span>:<span class="number">3</span>:<span class="number">0.01</span>,<span class="number">-3</span>:<span class="number">3</span>:<span class="number">0.01</span>]</span><br><span class="line">grid = np.c_[xx.ravel(),yy.ravel()]</span><br><span class="line">probs = sess.run(y,feed_dict=&#123;x:grid&#125;)</span><br><span class="line">probs = probs.reshape(xx.shape)</span><br><span class="line"><span class="keyword">print</span> <span class="string">"w1:\n"</span>, sess.run(w1)</span><br><span class="line"><span class="keyword">print</span> <span class="string">"b1:\n"</span>, sess.run(b1)</span><br><span class="line"><span class="keyword">print</span> <span class="string">"w2:\n"</span>, sess.run(w2)</span><br><span class="line"><span class="keyword">print</span> <span class="string">"b2:\n"</span>, sess.run(b2)</span><br><span class="line">plt.scatter(X[:,<span class="number">0</span>],X[:,<span class="number">1</span>],c=np.squeeze(Y_c))</span><br><span class="line">plt.contour(xx,yy,probs,levels=[<span class="number">0.5</span>])</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œä»£ç ï¼Œæ•ˆæœå¦‚ä¸‹:<br>é¦–å…ˆï¼Œæ•°æ®é›†å®ç°å¯è§†åŒ–ï¼Œx0 + x1 &lt; 2 çš„ç‚¹æ˜¾ç¤ºçº¢è‰²ï¼Œ x0 + x1 â‰¥2 çš„ç‚¹æ˜¾ç¤ºè“è‰²ï¼Œå¦‚å›¾æ‰€ç¤º:<br><img src="8.png" alt><br>æ¥ç€ï¼Œæ‰§è¡Œæ— æ­£åˆ™åŒ–çš„è®­ç»ƒè¿‡ç¨‹ï¼ŒæŠŠçº¢è‰²çš„ç‚¹å’Œè“è‰²çš„ç‚¹åˆ†å¼€ï¼Œç”Ÿæˆæ›²çº¿å¦‚ä¸‹å›¾æ‰€ç¤º:<br><img src="9.png" alt><br>æœ€åï¼Œæ‰§è¡Œæœ‰æ­£åˆ™åŒ–çš„è®­ç»ƒè¿‡ç¨‹ï¼ŒæŠŠçº¢è‰²çš„ç‚¹å’Œè“è‰²çš„ç‚¹åˆ†å¼€ï¼Œç”Ÿæˆæ›²çº¿å¦‚ä¸‹å›¾æ‰€ç¤º:<br><img src="10.png" alt><br>å¯¹æ¯”æ— æ­£åˆ™åŒ–ä¸æœ‰æ­£åˆ™åŒ–æ¨¡å‹çš„è®­ç»ƒç»“æœï¼Œå¯çœ‹å‡ºæœ‰æ­£åˆ™åŒ–æ¨¡å‹çš„æ‹Ÿåˆæ›²çº¿å¹³æ»‘ï¼Œæ¨¡å‹å…·æœ‰æ›´å¥½çš„æ³› åŒ–èƒ½åŠ›ã€‚</p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/11/08/æ­å»ºç¥ç»ç½‘ç»œ/" rel="next" title="æ­å»ºç¥ç»ç½‘ç»œ">
                <i class="fa fa-chevron-left"></i> æ­å»ºç¥ç»ç½‘ç»œ
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            æ–‡ç« ç›®å½•
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            ç«™ç‚¹æ¦‚è§ˆ
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/uploads/yasuo.png" alt="xuli">
            
              <p class="site-author-name" itemprop="name">xuli</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">7</span>
                  <span class="site-state-item-name">æ—¥å¿—</span>
                </a>
              </div>
            

            

            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/619496775" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:x619496775@gmail.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://plus.google.com/yourname" target="_blank" title="Google">
                      
                        <i class="fa fa-fw fa-google"></i>Google</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://youtube.com/yourname" target="_blank" title="YouTube">
                      
                        <i class="fa fa-fw fa-youtube"></i>YouTube</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://instagram.com/yourname" target="_blank" title="Instagram">
                      
                        <i class="fa fa-fw fa-instagram"></i>Instagram</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#1"><span class="nav-number">1.</span> <span class="nav-text">1</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2"><span class="nav-number">2.</span> <span class="nav-text">2</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3"><span class="nav-number">3.</span> <span class="nav-text">3</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4"><span class="nav-number">4.</span> <span class="nav-text">4</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">xuli</span>

  
</div>


  <div class="powered-by">ç”± <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> å¼ºåŠ›é©±åŠ¨</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">ä¸»é¢˜ &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
